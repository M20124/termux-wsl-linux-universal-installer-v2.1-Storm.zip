name: üöÄ StormOS Auto Release

on:
  workflow_dispatch:          # ‚úÖ –ó–∞–ø—É—Å–∫ –≤—Ä—É—á–Ω—É (Actions ‚Üí Run Workflow)
  push:
    tags:
      - 'v*'                  # ‚úÖ –ê–≤—Ç–æ-–∑–∞–ø—É—Å–∫ —è–∫—â–æ —Ç–∏ —Å—Ç–≤–æ—Ä–∏—à —Ç–µ–≥ v4.0.0, v4.1.0 —Ç–æ—â–æ

jobs:
  build-and-release:
    runs-on: ubuntu-latest

    steps:
      - name: üì• –ö–ª–æ–Ω—É–≤–∞–Ω–Ω—è —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—é
        uses: actions/checkout@v3

      - name: üõ† –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è zip (—è–∫—â–æ –Ω–µ–º–∞—î)
        run: sudo apt-get update && sudo apt-get install -y zip

      - name: üóú –ü–∞–∫—É–≤–∞–Ω–Ω—è StormOS
        run: |
          mkdir -p build
          zip -r build/StormOS-${{ github.ref_name }}.zip . -x "*.git*" -x ".github/*"

      - name: üì§ –°—Ç–≤–æ—Ä–µ–Ω–Ω—è GitHub —Ä–µ–ª—ñ–∑—É + –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è ZIP
        uses: softprops/action-gh-release@v1
        with:
          files: build/StormOS-${{ github.ref_name }}.zip
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
